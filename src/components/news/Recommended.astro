---
import { SITE_URL } from '../../consts';
import { getCollection } from 'astro:content';
import FormattedDate from '../../components/FormattedDate.astro';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
).slice(0, 3);
---

<div class="container recommended">
	<h1 class="recommended-head">Recommended</h1>
	<ul>
		{
			posts.map((post) => (
				<li>
					<a href={`${SITE_URL}/blog/${post.id}/`}>
						<img width={720} height={360} src={`${SITE_URL}${post.data.heroImage}`} alt="" />
						<div class="text-container">
							<p class="date">
								<FormattedDate date={post.data.pubDate} />
								<span class="author">{post.data.author || "BILLYCASH"}</span>
							</p>
							<h4 class="title">{post.data.title}</h4>
						</div>
					</a>
				</li>
			))
		}
	</ul>
</div>

<style>
	.recommended {
		width: calc(100vw - 250px);
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		margin-bottom: 140px;
	}

	.recommended-head {
		font-family: Inter;
		font-weight: 500;
		font-size: 30px;
		line-height: 100%;
		letter-spacing: 6%;
		text-align: center;
		margin-bottom: 55px;
	}

	ul {
		display: flex;
		flex-wrap: wrap;
		gap: 2rem;
		list-style-type: none;
		margin: 0;
		padding: 0;
		justify-content: center;
	}

	ul li {
		width: calc(33.3% - 2rem);
		box-sizing: border-box;
		background: #FFFFFF;
		border: 1px solid #E4E6ED;
		box-shadow: 0px 16px 40px -16px rgba(2, 43, 71, 0.1);
		border-radius: 31.25px;
		flex: none;
		order: 0;
		flex-grow: 0;
		display: flex;
		flex-direction: column;
	}

	ul li:last-child {
		gap: 0; 
	}

	ul li * {
		text-decoration: none;
		transition: 0.2s ease;
	}

	ul li img {
		width: 100%;
		height: 302px;
		object-fit: cover;
		border-bottom-right-radius: 0px;
		border-bottom-left-radius: 0px;
		border-top-right-radius: 31.25px;
		border-top-left-radius: 31.25px;
		flex: none;
		order: 0;
		align-self: stretch;
	}

	ul li a {
		display: flex;
		flex-direction: column;
		height: 100%;
	}

	.text-container {
		flex-grow: 1;
		display: flex;
		flex-direction: column;
		justify-content: flex-start;
		margin-top: 10px;
		padding: 16px;
	}

	.date {
		margin: 0;
		color: rgb(var(--gray));
		font-size: 14px;
		line-height: 1.5;
	}

	.author::before {
		content: " | ";
		color: rgb(var(--gray));
	}

	.author {
		color: rgb(var(--gray));
		font-size: 14px;
	}

	.title {
		font-weight: 600;
		font-size: 18px;
		line-height: 120%;
		letter-spacing: -2%;
	}

	ul li a:hover h4,
	ul li a:hover .date,
	ul li a:hover .author {
		color: rgb(var(--accent));
	}

	ul a:hover img {
		box-shadow: var(--box-shadow);
	}

	@media (max-width: 720px) {
		ul {
			gap: 0.5em;
		}
		ul li {
			width: 100%;
			text-align: center;
		}
	}
</style>